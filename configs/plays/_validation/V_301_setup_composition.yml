id: V_301_setup_composition
version: "1.0.0"
description: |
  W4-P2 Validation: Multiple setups composed in blocks.
  Tests that multiple `setup:` references can combine with all/any logic.
tags: [validation, w4, setup, composition]

symbol: BTCUSDT
tf: "15m"
start_date: "2024-01-01"
end_date: "2024-01-07"
initial_capital: 10000.0

# Features from both setups declared inline
features:
  - id: rsi
    type: indicator
    tf: "15m"
    indicator_type: rsi
    params:
      length: 14
  - id: ema_fast
    type: indicator
    tf: "15m"
    indicator_type: ema
    params:
      length: 9
  - id: ema_slow
    type: indicator
    tf: "15m"
    indicator_type: ema
    params:
      length: 21

# Blocks using multiple setup references
blocks:
  - id: entry
    cases:
      # Both setups must be true (AND)
      - when:
          all:
            - setup: rsi_oversold
            - setup: ema_pullback
        emit:
          - action: entry_long
      # Either setup is enough (OR)
      - when:
          any:
            - setup: rsi_oversold
            - setup: ema_pullback
        emit:
          - action: entry_long
            metadata:
              confidence: low
    else:
      emit:
        - action: no_action
