# ═══════════════════════════════════════════════════════════════════════════════
# RSI_008: Bearish Failure Swing Strategy
# ═══════════════════════════════════════════════════════════════════════════════
# Pattern: After RSI crosses below 70, it fails to cross back above 70 and
#          breaks its prior low - strong bearish reversal signal
# From: RSI Cheat Sheet - Failure Swings section
#
# Implementation Note: Since DSL doesn't track RSI swing lows directly, we use:
# 1. RSI was overbought recently (occurred_within)
# 2. RSI declined and staying below overbought zone
# 3. RSI showing downward momentum (cross below threshold)
# 4. Price confirmation via swing/trend structure
# ═══════════════════════════════════════════════════════════════════════════════

version: "3.0.0"
name: "RSI_008_failure_swing_bear"
description: "Bearish failure swing: RSI declines from overbought without retesting"

symbol: "ETHUSDT"
tf: "1h"

account:
  starting_equity_usdt: 10000.0
  max_leverage: 3.0
  margin_mode: isolated_usdt
  min_trade_notional_usdt: 10.0
  fee_model:
    taker_bps: 5.5
    maker_bps: 2.0
  slippage_bps: 2.0

features:
  rsi_14:
    indicator: rsi
    params:
      length: 14
  ema_9:
    indicator: ema
    params:
      length: 9
  ema_21:
    indicator: ema
    params:
      length: 21

structures:
  exec:
    - type: swing
      key: swing
      params:
        left: 5
        right: 5

actions:
  entry_short:
    all:
      # RSI was overbought recently (within 10 bars)
      - occurred_within:
          bars: 10
          expr:
            - ["rsi_14", ">", 70]
      # RSI has declined and is now below the danger zone (65-)
      - ["rsi_14", "<", 65]
      # RSI staying in bearish zone (not retesting overbought)
      - ["rsi_14", ">", 40]
      # RSI showing downward momentum (cross below 60)
      - ["rsi_14", "cross_below", 60]
      # Price confirmation: recent swing high exists
      - lhs: {feature_id: "swing", field: "high_level"}
        op: ">"
        rhs: 0

  exit_short:
    any:
      # RSI reaches oversold
      - ["rsi_14", "<", 30]
      # RSI rises back above 65 (failed pattern)
      - ["rsi_14", ">", 65]

position_policy:
  mode: short_only
  exit_mode: first_hit
  max_positions_per_symbol: 1

risk:
  stop_loss_pct: 2.5
  take_profit_pct: 5.0
  max_position_pct: 30.0
