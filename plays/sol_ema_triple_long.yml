version: "3.0.0"
name: "sol_ema_triple_long"
description: |
  SOL/USDT bull flag catcher v1.
  Mirror of bear flag short strategy for bull months.
  1. Confirm uptrend on 4h (trend direction == 1, strength >= 1)
  2. Wait for pullback on 15m (price was below 21 EMA recently)
  3. Enter long when 9 EMA crosses back above 21 (flag breakout)
  4. RSI > 55, ADX > 25 for high-conviction entries only
  5. Exit when 4h trend ends
  Limit entry + limit TP for maker fees. 50% equity, 5x leverage.

symbol: "SOLUSDT"

timeframes:
  low_tf: "15m"
  med_tf: "4h"
  high_tf: "D"
  exec: "low_tf"

account:
  starting_equity_usdt: 10000.0
  max_leverage: 5.0
  margin_mode: "isolated_usdt"
  fee_model:
    taker_bps: 5.5
    maker_bps: 2.0
  slippage_bps: 2.0

features:
  ema_9:
    indicator: ema
    params: { length: 9 }

  ema_21:
    indicator: ema
    params: { length: 21 }

  ema_55:
    indicator: ema
    params: { length: 55 }

  ema_55_4h:
    indicator: ema
    params: { length: 55 }
    tf: "4h"

  atr_14:
    indicator: atr
    params: { length: 14 }

  rsi_14:
    indicator: rsi
    params: { length: 14 }

  adx_14:
    indicator: adx
    params: { length: 14 }

structures:
  med_tf:
    - type: swing
      key: swing_4h
      params: { left: 5, right: 5 }
    - type: trend
      key: trend_4h
      uses: swing_4h

  exec: []

entry:
  order_type: "LIMIT"
  limit_offset_pct: 0.05
  time_in_force: "GTC"

actions:
  entry_long:
    all:
      # 4h uptrend confirmed with strength
      - ["trend_4h.direction", "==", 1]
      - ["trend_4h.strength", ">=", 1]
      # Price above 4h 55 EMA (macro bullish)
      - ["close", ">", "ema_55_4h"]
      # Bull flag: price pulled back below 21 EMA recently
      - occurred_within:
          bars: 15
          expr:
            - ["close", "<", "ema_21"]
      # Flag breakout: 9 crosses back above 21
      - ["ema_9", "cross_above", "ema_21"]
      # Strong bullish momentum
      - ["rsi_14", ">", 55]
      # Trending market, not chop
      - ["adx_14.adx", ">", 25]

  exit_long:
    any:
      # Exit when 4h trend is no longer bullish
      - ["trend_4h.direction", "!=", 1]

position_policy:
  mode: "long_only"
  exit_mode: "first_hit"
  max_positions_per_symbol: 1

risk_model:
  stop_loss:
    type: "atr_multiple"
    value: 1.5
    atr_feature_id: "atr_14"
  take_profit:
    type: "rr_ratio"
    value: 3.0
  sizing:
    model: "percent_equity"
    value: 50.0
    max_leverage: 5.0
  tp_order_type: "Limit"
  sl_order_type: "Market"
