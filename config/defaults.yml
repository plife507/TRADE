# =============================================================================
# TRADE System Defaults
# =============================================================================
# Single source of truth for all default values.
# All code references this file - no hardcoding in .py files.
#
# These defaults are used when a Play doesn't specify a value.
# For production, Plays should explicitly set all values.
# =============================================================================

version: "1.0.0"

# -----------------------------------------------------------------------------
# Exchange: Bybit Perpetuals
# -----------------------------------------------------------------------------
# Source: https://www.bybit.com/en/help-center/article/Trading-Fee-Structure/
# Last verified: 2025-01
exchange:
  name: "bybit"
  instrument_type: "perp"  # Perpetual contracts only
  quote_ccy: "USDT"

# -----------------------------------------------------------------------------
# Fee Model (Bybit Perpetuals - Non-VIP)
# -----------------------------------------------------------------------------
fees:
  taker_bps: 5.5          # 0.055% - market orders
  maker_bps: 2.0          # 0.02% - limit orders
  liquidation_bps: 5.5    # Same as taker (Bybit uses taker fee for liquidations)

# -----------------------------------------------------------------------------
# Margin Model (Bybit Perpetuals)
# -----------------------------------------------------------------------------
# Defaults match Bybit BTCUSDT risk tier 1 (lowest tier):
#   Tier 1: maxLeverage=125, IMR=0.008, MMR=0.005, mmDeduction=0
# See: GET /v5/market/risk-limit for full tier table.
# Plays can override maintenance_margin_rate and mm_deduction for higher tiers.
margin:
  mode: "isolated"        # isolated only (no cross-margin)
  position_mode: "oneway" # one-way only (no hedge mode)
  maintenance_margin_rate: 0.005  # 0.5% MMR - Bybit BTCUSDT tier 1
  mm_deduction: 0.0               # Bybit mmDeduction (0 for tier 1)
  mark_price_source: "close"      # Use close as mark proxy in backtest

# -----------------------------------------------------------------------------
# Execution Model
# -----------------------------------------------------------------------------
execution:
  slippage_bps: 2.0       # Conservative slippage estimate
  min_trade_notional_usdt: 10.0   # Minimum trade size

# -----------------------------------------------------------------------------
# Risk Defaults
# -----------------------------------------------------------------------------
risk:
  max_leverage: 1.0       # Conservative default
  risk_per_trade_pct: 1.0 # 1% risk per trade
  max_drawdown_pct: 100.0  # No drawdown stop by default (opt-in)
  stop_equity_usdt: 0.0   # No equity floor by default
  # Position sizing caps (Bybit-aligned)
  max_position_equity_pct: 95.0  # Max position as % of equity (leaves room for fees)
  reserve_fee_buffer: true       # Reserve balance for entry+exit fees
  # G1-1: Daily loss limit (5% of typical 10K starting equity)
  max_daily_loss_usdt: 500.0     # Halt trading when daily loss exceeds this
  # G1-2: Funding rate check threshold
  max_funding_cost_pct: 1.0      # Block if funding_rate * leverage > 1% daily cost

# -----------------------------------------------------------------------------
# Account Defaults
# -----------------------------------------------------------------------------
account:
  starting_equity_usdt: 10000.0  # Default starting capital

# -----------------------------------------------------------------------------
# Position Policy Defaults
# -----------------------------------------------------------------------------
position_policy:
  mode: "long_only"
  exit_mode: "sl_tp_only"
  max_positions_per_symbol: 1

# -----------------------------------------------------------------------------
# Engine Defaults
# -----------------------------------------------------------------------------
engine:
  warmup_bars: 100              # Bars to warm up indicators before trading
  state_save_interval: 100      # Bars between state snapshots
  max_warmup_bars: 1000         # Maximum warmup period allowed

# -----------------------------------------------------------------------------
# Windowing Defaults
# -----------------------------------------------------------------------------
# Safety margins for multi-timeframe bar history
windowing:
  high_tf_safety_closes: 10     # Extra bars to keep for higher timeframe
  med_tf_safety_closes: 20      # Extra bars to keep for medium timeframe
  max_window_bars: 100          # Default max window for HoldsFor/OccurredWithin

# -----------------------------------------------------------------------------
# Impact Model Defaults
# -----------------------------------------------------------------------------
impact:
  max_impact_bps: 100.0         # 1% max price impact cap
