version: "3.0.0"
name: "V_134_multi_tf_roles"
description: "Validation: Multi-TF role naming - Tests high_tf, med_tf features with exec TF entry timing."

symbol: "BTCUSDT"
tf: "5m"
high_tf: "4h"
med_tf: "1h"

account:
  starting_equity_usdt: 10000.0
  max_leverage: 1.0
  margin_mode: isolated_usdt
  min_trade_notional_usdt: 10.0
  fee_model:
    taker_bps: 5.5
    maker_bps: 2.0
  slippage_bps: 2.0

features:
  # Exec TF (5m) - Entry timing
  ema_9:
    indicator: ema
    params:
      length: 9
  ema_21:
    indicator: ema
    params:
      length: 21
  rsi_14:
    indicator: rsi
    params:
      length: 14

  # MedTF (1h) - Trade bias
  ema_50_1h:
    indicator: ema
    tf: "1h"
    params:
      length: 50
  rsi_14_1h:
    indicator: rsi
    tf: "1h"
    params:
      length: 14

  # HighTF (4h) - Trend context
  ema_200_4h:
    indicator: ema
    tf: "4h"
    params:
      length: 200

actions:
  entry_long:
    all:
      # HighTF: Confirm uptrend context
      - ["close", ">", "ema_200_4h"]
      # MedTF: Trade bias filter
      - ["close", ">", "ema_50_1h"]
      - ["rsi_14_1h", "<", 70]
      # ExecTF: Entry signal
      - ["ema_9", "cross_above", "ema_21"]
      - ["rsi_14", "<", 60]
  exit_long:
    any:
      # Exit on exec TF signal
      - ["ema_9", "cross_below", "ema_21"]
      # Or if MedTF bias flips
      - ["close", "<", "ema_50_1h"]

position_policy:
  mode: long_only
  exit_mode: first_hit
  max_positions_per_symbol: 1

risk:
  stop_loss_pct: 2.0
  take_profit_pct: 4.0
  max_position_pct: 10.0

_test_metadata:
  validation_id: "V_134"
  category: "multi_tf"
  tests:
    - "3-tier TF hierarchy: high_tf (4h), med_tf (1h), exec (5m)"
    - "high_tf trend context filter"
    - "med_tf trade bias filter"
    - "exec TF entry timing"
    - "Forward-fill behavior at each TF level"
    - "New role naming convention (high_tf, med_tf, low_tf)"
