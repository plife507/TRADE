version: 3.0.0
name: S4_L_010_lev_1x
description: "Leverage Test: 1x leverage baseline (long)."
symbol: BTCUSDT
tf: 15m

account:
  starting_equity_usdt: 10000.0
  max_leverage: 1.0
  margin_mode: isolated_usdt
  min_trade_notional_usdt: 10.0
  fee_model:
    taker_bps: 6.0
    maker_bps: 1.0
  slippage_bps: 2.0

features:
  ema_9:
    indicator: ema
    params:
      length: 9
  ema_21:
    indicator: ema
    params:
      length: 21

actions:
  entry_long:
    all:
      - [ema_9, "cross_above", ema_21]
  exit_long:
    any:
      - [ema_9, "cross_below", ema_21]

position_policy:
  mode: long_only
  exit_mode: first_hit
  max_positions_per_symbol: 1

risk:
  stop_loss_pct: 2.0
  take_profit_pct: 4.0
  max_position_pct: 10.0

_test_metadata:
  gate: "order_01"
  category: leverage
  leverage: 1
  # ROI-based SL/TP validation (2026-01-10 fix)
  # sl_pct: 2.0 with 1x leverage = 2.0% price move to trigger SL
  # At 1x, ROI% = price move % (no amplification)
  expected_sl_price_move_pct: 2.0
  expected_roi_at_sl: -2.0
  tests:
    - leverage_1x_margin
    - leverage_1x_pnl
    - roi_based_sl_validation
